<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uzbekistan's Celestial Legacy</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&family=Exo+2:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- GLOBAL & BACKGROUND (Deep Space Theme) --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Exo 2', sans-serif;
            background: #020408;
            color: #c8dce8;
            overflow: hidden;
            height: 100vh;
        }
        
        /* Deep space background with nebula effect */
        .space-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 20% 20%, rgba(15, 35, 80, 0.4) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(40, 20, 60, 0.3) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(5, 15, 35, 0.8) 0%, transparent 70%),
                linear-gradient(180deg, #020408 0%, #050a14 30%, #0a1020 60%, #050810 100%);
            z-index: -1;
        }
        
        /* Enhanced Stars with multiple layers */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 4s infinite ease-in-out;
        }
        
        .star.bright {
            animation: twinkleBright 2.5s infinite ease-in-out;
            box-shadow: 0 0 3px rgba(255, 255, 255, 0.5);
        }
        
        .star.blue {
            background: #7ec8e3;
            box-shadow: 0 0 4px rgba(126, 200, 227, 0.6);
        }
        
        .star.gold {
            background: #ffd700;
            box-shadow: 0 0 4px rgba(255, 215, 0, 0.6);
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.3); }
        }
        
        @keyframes twinkleBright {
            0%, 100% { opacity: 0.4; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }
        
        /* Nebula clouds */
        .nebula {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.15;
            pointer-events: none;
            animation: nebulaPulse 15s infinite ease-in-out;
        }
        
        @keyframes nebulaPulse {
            0%, 100% { opacity: 0.1; transform: scale(1); }
            50% { opacity: 0.2; transform: scale(1.1); }
        }
        
        /* --- HEADER --- */
        .header {
            background: linear-gradient(135deg, rgba(5, 10, 25, 0.95) 0%, rgba(10, 15, 30, 0.95) 100%);
            backdrop-filter: blur(25px);
            border-bottom: 1px solid rgba(100, 180, 255, 0.15);
            padding: 8px 40px;
            position: relative;
            box-shadow: 0 4px 40px rgba(0, 0, 0, 0.8);
        }
        
        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(100, 180, 255, 0.4), transparent);
        }
        
        .header-content {
            max-width: 2400px;
            margin: 0 auto;
        }
        
        h1 {
            font-family: 'Chakra Petch', sans-serif;
            font-size: 1.6rem;
            font-weight: 700;
            color: #64b4ff;
            letter-spacing: 4px;
            margin-bottom: 2px;
            text-transform: uppercase;
            text-shadow: 0 0 20px rgba(100, 180, 255, 0.5);
        }
        
        .subtitle {
            color: #5a8ab8;
            font-size: 0.7rem;
            letter-spacing: 2px;
            font-weight: 400;
            margin-left: 45px;
            opacity: 0.9;
        }
        
        /* --- MAIN LAYOUT --- */
        .main-container {
            max-width: 2400px;
            height: calc(100vh - 65px);
            margin: 0 auto;
            padding: 8px 15px;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 12px;
            align-items: stretch;
        }
        
        /* --- LEFT PANEL (Discovery) --- */
        .discovery-panel {
            background: linear-gradient(145deg, rgba(8, 15, 35, 0.9) 0%, rgba(5, 10, 25, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(100, 180, 255, 0.15);
            border-radius: 12px;
            padding: 12px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.7),
                inset 0 1px 0 rgba(100, 180, 255, 0.1);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        /* Custom scrollbar */
        .discovery-panel::-webkit-scrollbar {
            width: 4px;
        }
        
        .discovery-panel::-webkit-scrollbar-track {
            background: rgba(100, 180, 255, 0.05);
            border-radius: 10px;
        }
        
        .discovery-panel::-webkit-scrollbar-thumb {
            background: rgba(100, 180, 255, 0.25);
            border-radius: 10px;
        }
        
        .panel-title {
            font-family: 'Chakra Petch', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            color: #64b4ff;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(100, 180, 255, 0.2);
            letter-spacing: 2px;
            text-transform: uppercase;
            text-shadow: 0 0 10px rgba(100, 180, 255, 0.3);
        }
        
        .discovery-section {
            margin-bottom: 10px;
        }
        
        .section-label {
            font-size: 0.65rem;
            color: #4a90c8;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 8px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .section-divider {
            margin: 10px 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(100, 180, 255, 0.2), transparent);
        }
        
        .discovery-item {
            display: flex;
            align-items: center;
            padding: 6px 8px;
            margin: 4px 0;
            background: transparent;
            border-left: 2px solid transparent;
            border-radius: 6px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .discovery-item:hover {
            background: rgba(100, 180, 255, 0.08);
            transform: translateX(4px);
            box-shadow: 0 0 20px rgba(100, 180, 255, 0.15);
            border-left-color: #64b4ff;
        }
        
        .discovery-icon {
            font-size: 0.9rem;
            margin-right: 8px;
        }
        
        .discovery-text {
            font-size: 0.75rem;
            color: #c8dce8;
            line-height: 1.3;
        }
        
        /* Observatory items */
        .observatory-item {
            padding: 8px 10px;
            margin: 5px 0;
            background: rgba(100, 180, 255, 0.04);
            border-left: 2px solid #4a90c8;
            border-radius: 6px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .observatory-item.historic {
            border-left-color: #e8a0b0;
            background: rgba(232, 160, 176, 0.04);
        }
        
        .observatory-item.modern {
            border-left-color: #7ec8e3;
            background: rgba(126, 200, 227, 0.04);
        }
        
        .observatory-item.educational {
            border-left-color: #d4a855;
            background: rgba(212, 168, 85, 0.04);
        }
        
        .observatory-item:hover {
            transform: translateX(4px);
            box-shadow: 0 0 25px rgba(100, 180, 255, 0.2);
        }
        
        .observatory-item.historic:hover {
            background: rgba(232, 160, 176, 0.1);
            box-shadow: 0 0 25px rgba(232, 160, 176, 0.2);
        }
        
        .observatory-item.modern:hover {
            background: rgba(126, 200, 227, 0.1);
            box-shadow: 0 0 25px rgba(126, 200, 227, 0.2);
        }
        
        .observatory-item.educational:hover {
            background: rgba(212, 168, 85, 0.1);
            box-shadow: 0 0 25px rgba(212, 168, 85, 0.2);
        }
        
        .observatory-name {
            font-weight: 600;
            color: #7ec8e3;
            font-size: 0.75rem;
            margin-bottom: 2px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .observatory-item.historic .observatory-name {
            color: #e8a0b0;
        }
        
        .observatory-item.educational .observatory-name {
            color: #d4a855;
        }
        
        .observatory-type {
            font-size: 0.65rem;
            color: #6a9ac0;
            opacity: 0.9;
        }
        
        .type-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-top: 4px;
        }
        
        .badge-historic {
            background: rgba(232, 160, 176, 0.15);
            color: #e8a0b0;
            border: 1px solid rgba(232, 160, 176, 0.3);
        }
        
        .badge-modern {
            background: rgba(126, 200, 227, 0.15);
            color: #7ec8e3;
            border: 1px solid rgba(126, 200, 227, 0.3);
        }
        
        .badge-educational {
            background: rgba(212, 168, 85, 0.15);
            color: #d4a855;
            border: 1px solid rgba(212, 168, 85, 0.3);
        }
        
        /* --- MAP SECTION --- */
        .map-section {
            background: linear-gradient(145deg, rgba(8, 15, 35, 0.85) 0%, rgba(5, 10, 25, 0.9) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(100, 180, 255, 0.12);
            border-radius: 12px;
            padding: 8px;
            box-shadow: 
                0 8px 40px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(100, 180, 255, 0.08);
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }
        
        .map-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            padding-bottom: 6px;
            border-bottom: 1px solid rgba(100, 180, 255, 0.1);
            flex-shrink: 0;
        }
        
        .map-title {
            font-family: 'Chakra Petch', sans-serif;
            font-size: 0.9rem;
            color: #64b4ff;
            font-weight: 600;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(100, 180, 255, 0.3);
        }
        
        .map-controls {
            display: flex;
            gap: 8px;
        }
        
        .control-hint {
            font-size: 0.6rem;
            color: #5a8ab8;
            background: rgba(100, 180, 255, 0.06);
            padding: 4px 10px;
            border-radius: 12px;
            border: 1px solid rgba(100, 180, 255, 0.15);
            font-family: 'Chakra Petch', monospace;
            letter-spacing: 0.5px;
        }
        
        .map-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
            width: 100%;
            position: relative;
        }
        
        #globe {
            width: 100%;
            flex: 1;
            border-radius: 8px;
            overflow: hidden;
            min-height: 0;
        }
        
        /* Force Plotly to fill container */
        #globe .js-plotly-plot,
        #globe .plot-container,
        #globe .svg-container {
            width: 100% !important;
            height: 100% !important;
        }
        
        #globe .main-svg {
            width: 100% !important;
            height: 100% !important;
        }
        
        #globe .geo {
            width: 100% !important;
        }
        
        /* --- BOTTOM SECTION --- */
        .bottom-section {
            margin-top: 6px;
            flex-shrink: 0;
        }
        
        /* Legend */
        .legend {
            padding: 6px 10px;
            background: rgba(8, 15, 35, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(100, 180, 255, 0.1);
            margin-bottom: 6px;
        }
        
        .legend-title {
            font-family: 'Chakra Petch', sans-serif;
            font-size: 0.7rem;
            color: #64b4ff;
            margin-bottom: 6px;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .legend-items {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.65rem;
            color: #8ab8d8;
        }
        
        .legend-symbol {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
            box-shadow: 0 0 6px currentColor;
        }
        
        .legend-symbol.star {
            border-radius: 0;
            background: #e8a0b0;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            box-shadow: 0 0 8px rgba(232, 160, 176, 0.6);
        }
        
        /* --- STATS CARDS --- */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 6px;
        }
        
        .stat-card {
            background: linear-gradient(145deg, rgba(100, 180, 255, 0.06) 0%, rgba(100, 180, 255, 0.02) 100%);
            border: 1px solid rgba(100, 180, 255, 0.12);
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            background: linear-gradient(145deg, rgba(100, 180, 255, 0.1) 0%, rgba(100, 180, 255, 0.04) 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(100, 180, 255, 0.15);
        }
        
        .stat-value {
            font-family: 'Chakra Petch', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: #64b4ff;
            line-height: 1;
            text-shadow: 0 0 15px rgba(100, 180, 255, 0.4);
        }
        
        .stat-label {
            font-size: 0.6rem;
            color: #5a8ab8;
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Info Box */
        .info-box {
            margin-top: 6px;
            padding: 8px 12px;
            background: rgba(212, 168, 85, 0.06);
            border: 1px solid rgba(212, 168, 85, 0.2);
            border-radius: 8px;
            border-left: 3px solid #d4a855;
        }
        
        .info-text {
            font-size: 0.68rem;
            color: #c8dce8;
            line-height: 1.5;
            text-align: center;
        }
        
        .info-highlight {
            color: #d4a855;
            font-weight: 600;
        }
        
        /* Responsive */
        @media (max-width: 1400px) {
            .main-container {
                grid-template-columns: 260px 1fr;
            }
            
            .legend-items {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .discovery-panel {
                max-height: 350px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .legend-items {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="space-bg">
        <div class="stars" id="stars"></div>
        <!-- Nebula clouds -->
        <div class="nebula" style="width: 600px; height: 400px; top: -100px; left: -100px; background: radial-gradient(ellipse, rgba(60, 100, 180, 0.4), transparent);"></div>
        <div class="nebula" style="width: 500px; height: 350px; bottom: -50px; right: -50px; background: radial-gradient(ellipse, rgba(100, 50, 120, 0.3), transparent); animation-delay: -7s;"></div>
        <div class="nebula" style="width: 400px; height: 300px; top: 50%; left: 30%; background: radial-gradient(ellipse, rgba(40, 80, 140, 0.2), transparent); animation-delay: -3s;"></div>
    </div>
    
    <header class="header">
        <div class="header-content">
            <h1>üõ∞Ô∏è UZBEKISTAN'S CELESTIAL LEGACY</h1>
            <p class="subtitle">Mapping 600 Years of Astronomical Excellence</p>
        </div>
    </header>
    
    <div class="main-container">
        <aside class="discovery-panel">
            <div class="panel-title">‚ö° CELESTIAL DISCOVERIES</div>
            
            <div class="discovery-section">
                <div class="section-label">ü™® NAMED ASTEROIDS</div>
                <div class="discovery-item" data-name="(1381) Uzbekistania">
                    <span class="discovery-icon" style="color:#ff5a5a;">üî¥</span>
                    <span class="discovery-text"><strong>(1381) Uzbekistania</strong></span>
                </div>
                <div class="discovery-item" data-name="(2170271) Samarkand">
                    <span class="discovery-icon" style="color:#ff9a4a;">üü†</span>
                    <span class="discovery-text"><strong>(2170271) Samarkand</strong></span>
                </div>
                <div class="discovery-item" data-name="(2439) Ulugbek">
                    <span class="discovery-icon" style="color:#ffd84a;">üü°</span>
                    <span class="discovery-text"><strong>(2439) Ulugbek</strong></span>
                </div>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="discovery-section">
                <div class="section-label">üåô LUNAR FEATURES</div>
                <div class="discovery-item">
                    <span class="discovery-icon" style="color:#7ec8e3;">üåô</span>
                    <span class="discovery-text"><strong>Ulugh Beigh Crater</strong><br><small style="color:#6a9ac0;">Named after astronomer-king</small></span>
                </div>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="discovery-section">
                <div class="section-label">üèõÔ∏è HISTORIC OBSERVATORIES</div>
                <div class="observatory-item historic" data-name="Ulugh Beg Observatory">
                    <div class="observatory-name">‚≠ê Ulugh Beg Observatory</div>
                    <div class="observatory-type">Samarkand, 1420s</div>
                    <span class="type-badge badge-historic">HISTORIC</span>
                </div>
                <div class="observatory-item historic" data-name="Tashkent Astronomical Observatory">
                    <div class="observatory-name">‚≠ê Tashkent Astronomical Obs.</div>
                    <div class="observatory-type">Est. 1873 ‚Ä¢ First in Central Asia</div>
                    <span class="type-badge badge-historic">HISTORIC</span>
                </div>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="discovery-section">
                <div class="section-label">üõ∞Ô∏è MODERN OBSERVATORIES</div>
                <div class="observatory-item modern" data-name="Maidanak Observatory">
                    <div class="observatory-name">üî≠ Maidanak Observatory</div>
                    <div class="observatory-type">2650m ‚Ä¢ 80+ asteroids</div>
                    <span class="type-badge badge-modern">RESEARCH</span>
                </div>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="discovery-section">
                <div class="section-label">üéì EDUCATIONAL</div>
                <div class="observatory-item educational" data-name="Samarkand State University Observatory">
                    <div class="observatory-name">üìö Samarkand State Univ.</div>
                    <div class="observatory-type">2006 ‚Ä¢ 48cm telescope</div>
                    <span class="type-badge badge-educational">EDUCATION</span>
                </div>
                <div class="observatory-item educational" data-name="Tashkent State Pedagogical University Observatory">
                    <div class="observatory-name">üìö TSPU Observatory</div>
                    <div class="observatory-type">14-inch Celestron</div>
                    <span class="type-badge badge-educational">EDUCATION</span>
                </div>
            </div>
        </aside>
        
        <main class="map-section">
            <div class="map-header">
                <div class="map-title">üåç UZBEKISTAN'S ASTRONOMICAL NETWORK</div>
                <div class="map-controls">
                    <span class="control-hint">üñ±Ô∏è Drag to Rotate</span>
                    <span class="control-hint">üîç Scroll to Zoom</span>
                </div>
            </div>
            
            <div class="map-content">
                <div id="globe"></div>
            </div>
            
            <div class="bottom-section">
                <div class="legend">
                    <div class="legend-title">üó∫Ô∏è MAP LEGEND</div>
                    <div class="legend-items">
                        <div class="legend-item">
                            <div class="legend-symbol star"></div>
                            <span>Historic Observatory</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-symbol" style="background: #7ec8e3;"></div>
                            <span>Modern Research</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-symbol" style="background: #d4a855;"></div>
                            <span>Educational</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-symbol" style="background: #5cb85c;"></div>
                            <span>Museum</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-symbol" style="background: #ff5a5a;"></div>
                            <span>Named Asteroid</span>
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">80+</div>
                        <div class="stat-label">Asteroids Discovered</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">4</div>
                        <div class="stat-label">Comets Found</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">1,018</div>
                        <div class="stat-label">Stars Cataloged</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">5</div>
                        <div class="stat-label">Active Observatories</div>
                    </div>
                </div>
                
                <div class="info-box">
                    <p class="info-text">
                        <span class="info-highlight">Ulug' Beg (1394-1449)</span>, Astronomer-King of Samarkand, created the most accurate star catalog between Ptolemy and Tycho Brahe. His legacy lives on through <span class="info-highlight">Maidanak Observatory</span>, one of the best observing sites in the Northern Hemisphere with 80+ asteroid discoveries.
                    </p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Generate enhanced star field with variety
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const colors = ['white', 'blue', 'gold'];
            
            for (let i = 0; i < 200; i++) {
                const star = document.createElement('div');
                const isBright = Math.random() < 0.08;
                const colorType = Math.random();
                
                let colorClass = '';
                if (colorType > 0.95) colorClass = 'blue';
                else if (colorType > 0.92) colorClass = 'gold';
                
                star.className = `star ${isBright ? 'bright' : ''} ${colorClass}`;
                
                const size = isBright ? (Math.random() * 1.5 + 1.5) : (Math.random() * 1 + 0.5);
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 6 + 's';
                star.style.animationDuration = (Math.random() * 3 + 3) + 's';
                
                starsContainer.appendChild(star);
            }
        }
        createStars();

        // Enhanced observatory data
        const observatories = [
            {
                name: "Ulugh Beg Observatory",
                country: "Uzbekistan",
                type: "Historic Site",
                lat: 39.6753,
                lon: 66.8851,
                details: "Built 1420s ‚Ä¢ 1,018 Stars Cataloged ‚Ä¢ Most accurate catalog between Ptolemy and Tycho Brahe",
                color: "#e8a0b0",
                symbol: 'star',
                size: 24,
                showText: true
            },
            {
                name: "Tashkent Astronomical Observatory",
                country: "Uzbekistan",
                type: "Historic Institution",
                lat: 41.327,
                lon: 69.281,
                details: "Established 1873 ‚Ä¢ First scientific institution in Central Asia ‚Ä¢ Astronomy Museum with UNESCO",
                color: "#e8a0b0",
                symbol: 'star',
                size: 22,
                showText: true
            },
            {
                name: "Maidanak Observatory",
                country: "Uzbekistan", 
                type: "Modern Research Facility",
                lat: 38.6761,
                lon: 66.8967,
                details: "Altitude 2650m ‚Ä¢ 80+ Asteroids ‚Ä¢ 4 Comets ‚Ä¢ 2,000 clear hours/year ‚Ä¢ Best in Northern Hemisphere",
                color: "#7ec8e3",
                symbol: 'circle',
                size: 22,
                showText: false
            },
            {
                name: "Samarkand State University Observatory",
                country: "Uzbekistan",
                type: "Educational Observatory",
                lat: 39.580,  
                lon: 67.100,
                details: "Established 2006 ‚Ä¢ First educational observatory in Central Asia ‚Ä¢ 48cm Grubb Parsons telescope",
                color: "#d4a855",
                symbol: 'circle',
                size: 18,
                showText: false
            },
            {
                name: "Tashkent State Pedagogical University Observatory",
                country: "Uzbekistan",
                type: "Educational",
                lat: 41.250,  
                lon: 69.500,
                details: "Celestron 14-inch telescope ‚Ä¢ Trains astronomy teachers and students",
                color: "#d4a855",
                symbol: 'circle',
                size: 16,
                showText: false
            }
        ];

        // Celestial objects
        const celestialObjects = [
            {name: "(1381) Uzbekistania", lat: 40.2, lon: 66.2, type: "Asteroid", color: "#ff5a5a", size: 14},
            {name: "(2170271) Samarkand", lat: 39.2, lon: 67.5, type: "Asteroid", color: "#ff9a4a", size: 14},
            {name: "(2439) Ulugbek", lat: 38.8, lon: 68.2, type: "Asteroid", color: "#ffd84a", size: 14},
        ];

        // Create traces
        const traces = [];
        
        // Observatory markers
        observatories.forEach(obs => {
            traces.push({
                type: 'scattergeo',
                mode: obs.showText ? 'markers+text' : 'markers',
                name: obs.name,
                lon: [obs.lon],
                lat: [obs.lat],
                text: obs.showText ? [obs.name] : undefined,
                textposition: 'top center',
                textfont: {
                    size: 11,
                    color: obs.color,
                    family: 'Chakra Petch, sans-serif',
                    weight: 600
                },
                marker: {
                    size: obs.size,
                    color: obs.color,
                    symbol: obs.symbol,
                    line: {
                        width: 2,
                        color: 'rgba(255, 255, 255, 0.8)'
                    },
                    opacity: 0.95
                },
                hovertext: `<b style="font-size: 15px; color: ${obs.color};">${obs.name}</b><br>` +
                            `<span style="color: #c8dce8;">üìç ${obs.country}</span><br>` +
                            `<span style="color: #8ab8d8;">‚ö° ${obs.type}</span><br><br>` +
                            `<i style="color: #6a9ac0;">${obs.details}</i>`,
                hoverinfo: 'text',
                hoverlabel: {
                    bgcolor: 'rgba(8, 15, 35, 0.95)',
                    bordercolor: obs.color,
                    font: {
                        family: 'Exo 2, sans-serif',
                        size: 12,
                        color: '#c8dce8'
                    }
                }
            });
        });

        // Asteroid markers
        celestialObjects.forEach(obj => {
            traces.push({
                type: 'scattergeo',
                mode: 'markers',
                name: obj.name,
                lon: [obj.lon],
                lat: [obj.lat],
                marker: {
                    size: obj.size,
                    color: obj.color,
                    symbol: 'circle',
                    line: {
                        width: 2,
                        color: 'rgba(255, 255, 255, 0.7)'
                    },
                    opacity: 0.95
                },
                hovertext: `<b style="font-size: 14px; color: ${obj.color};">${obj.name}</b><br>` +
                            `<span style="color: #c8dce8;">ü™® Named Asteroid</span><br>` +
                            `<span style="color: #8ab8d8;">Discovered at Maidanak Observatory</span>`,
                hoverinfo: 'text',
                hoverlabel: {
                    bgcolor: 'rgba(8, 15, 35, 0.95)',
                    bordercolor: obj.color,
                    font: {
                        family: 'Exo 2, sans-serif',
                        size: 12,
                        color: '#c8dce8'
                    }
                }
            });
        });

        // Layout - DEEP SPACE THEME with full container coverage
        const layout = {
            geo: {
                projection: {
                    type: 'mercator'
                },
                // Domain fills 100% of the plot area
                domain: {
                    x: [0, 1],
                    y: [0, 1]
                },
                center: {
                    lon: 64,
                    lat: 41
                },
                visible: true,
                showland: true,
                landcolor: '#0a1525',
                countrycolor: '#2a5080',
                countrywidth: 1.5,
                coastlinecolor: '#3a6090',
                coastlinewidth: 1.2,
                showocean: true,
                oceancolor: '#040810',
                showlakes: true,
                lakecolor: '#081018',
                showcountries: true,
                bgcolor: 'rgba(0, 0, 0, 0)',
                showframe: false,
                showcoastlines: true,
                resolution: 50,
                // Much wider longitude range to fill horizontal space completely
                lonaxis: {
                    range: [45, 85],
                    showgrid: true,
                    gridcolor: 'rgba(60, 120, 180, 0.08)',
                    gridwidth: 0.5
                },
                lataxis: {
                    range: [33, 49],
                    showgrid: true,
                    gridcolor: 'rgba(60, 120, 180, 0.08)',
                    gridwidth: 0.5
                }
            },
            showlegend: false,
            margin: {
                l: 0,
                r: 0,
                t: 0,
                b: 0,
                pad: 0
            },
            paper_bgcolor: 'rgba(0, 0, 0, 0)',
            plot_bgcolor: 'rgba(0, 0, 0, 0)',
            font: {
                color: '#c8dce8',
                family: 'Exo 2, sans-serif'
            },
            autosize: true
        };

        const config = {
            displayModeBar: true,
            displaylogo: false,
            modeBarButtonsToRemove: ['lasso2d', 'select2d'],
            scrollZoom: true,
            responsive: true,
            doubleClick: 'reset'
        };

        // Create the map
        Plotly.newPlot('globe', traces, layout, config).then(function() {
            // Force the geo to fill the container after initial render
            resizeMap();
        });

        // Handle resize to ensure full container coverage
        function resizeMap() {
            const container = document.getElementById('globe');
            const width = container.offsetWidth;
            const height = container.offsetHeight;
            
            if (width === 0 || height === 0) return;
            
            // Calculate aspect ratio
            const aspectRatio = width / height;
            
            // Base latitude range (centered on Uzbekistan)
            const centerLat = 41;
            const centerLon = 65;
            const latSpan = 16; // Total latitude span
            
            // Calculate longitude span to fill width
            // Mercator: lonSpan = latSpan * aspectRatio / cos(centerLat in radians)
            const cosLat = Math.cos(centerLat * Math.PI / 180);
            const lonSpan = latSpan * aspectRatio / cosLat;
            
            Plotly.relayout('globe', {
                'width': width,
                'height': height,
                'geo.center.lat': centerLat,
                'geo.center.lon': centerLon,
                'geo.lonaxis.range': [centerLon - lonSpan/2, centerLon + lonSpan/2],
                'geo.lataxis.range': [centerLat - latSpan/2, centerLat + latSpan/2]
            });
        }
        
        window.addEventListener('resize', resizeMap);
        
        // Multiple resize calls to catch late renders
        setTimeout(resizeMap, 100);
        setTimeout(resizeMap, 300);
        setTimeout(resizeMap, 600);

        // Interactive highlighting
        const globeEl = document.getElementById('globe');
        const allItems = document.querySelectorAll('.observatory-item, .discovery-item');
        const traceData = [...observatories, ...celestialObjects];

        allItems.forEach(item => {
            const itemName = item.dataset.name;
            if (!itemName) return;

            const traceIndex = traceData.findIndex(d => d.name === itemName);
            if (traceIndex === -1) return;

            const dataPoint = traceData[traceIndex];
            const isObservatory = !!observatories.find(d => d.name === itemName);
            const originalSize = dataPoint.size || (isObservatory ? 20 : 14);
            const originalLineWidth = 2;
            const originalLineColor = isObservatory ? 'rgba(255, 255, 255, 0.8)' : 'rgba(255, 255, 255, 0.7)';

            item.addEventListener('mouseenter', () => {
                Plotly.restyle('globe', {
                    'marker.size': [originalSize * 1.5],
                    'marker.line.width': [4],
                    'marker.line.color': ['#ffd84a'],
                    'marker.opacity': [1]
                }, [traceIndex]);
            });

            item.addEventListener('mouseleave', () => {
                Plotly.restyle('globe', {
                    'marker.size': [originalSize],
                    'marker.line.width': [originalLineWidth],
                    'marker.line.color': [originalLineColor],
                    'marker.opacity': [0.95]
                }, [traceIndex]);
            });

            item.addEventListener('click', () => {
                // Zoom into the clicked location
                const zoomLatSpan = 6;
                const container = document.getElementById('globe');
                const aspectRatio = container.offsetWidth / container.offsetHeight;
                const cosLat = Math.cos(dataPoint.lat * Math.PI / 180);
                const zoomLonSpan = zoomLatSpan * aspectRatio / cosLat;
                
                Plotly.relayout('globe', {
                    'geo.center.lon': dataPoint.lon,
                    'geo.center.lat': dataPoint.lat,
                    'geo.lonaxis.range': [dataPoint.lon - zoomLonSpan/2, dataPoint.lon + zoomLonSpan/2],
                    'geo.lataxis.range': [dataPoint.lat - zoomLatSpan/2, dataPoint.lat + zoomLatSpan/2]
                });
            });
        });
    </script>
</body>
</html>